<!DOCTYPE html>
<html lang="en">
<head>
    <!-- IMPORTANT: Make sure your text editor saves this file with UTF-8 Encoding! -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCIE 1012 Chapter 5 Quiz</title> <!-- Changed Title -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input[type="text"], input[type="email"], input[type="tel"], input[type="password"] { width: 100%; padding: 8px; box-sizing: border-box; }
        input[type="radio"] { margin-right: 5px; vertical-align: middle;}
        button { padding: 10px 20px; background-color: #007bff; color: white; border: none; cursor: pointer; margin-right: 10px; border-radius: 5px; }
        button:hover { background-color: #0056b3; }
        .hidden { display: none; }
        #error-message, #password-error, #login-error { color: red; font-size: 1.2em; text-align: center; }
        #success-message { color: green; font-size: 1.2em; text-align: center; }
        #results, #review-section, #submission-copy { margin-top: 20px; text-align: left; border: 1px solid #ccc; padding: 15px; border-radius: 5px; background-color: #f9f9f9;}
        #password-section, #login-section { text-align: center; max-width: 400px; margin: 20px auto; padding: 20px; border: 1px solid #ccc; border-radius: 5px; background-color: #f9f9f9;}
        #password-section input[type="password"], #login-section input[type="text"], #login-section input[type="password"] { width: calc(100% - 18px); }
        .question-result { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px solid #eee; }
        #download-pdf, #download-response { margin-top: 10px; }
        #score { font-weight: bold; text-align: center; color: green; font-size: 1.4em; margin-top: 20px; }
        #review-section h2, #submission-copy h2, #results h1 { margin-bottom: 15px; text-align: center; color: #007bff;}
        #review-section button, #submission-copy button, #password-section button, #login-section button, #results button { margin-top: 15px; }
        .choices p { margin: 2px 0 2px 20px; }
        .form-group span { display: inline-block; margin-left: 3px; margin-right: 15px;}
    </style>
</head>
<body>
    <div id="login-section">
        <h1>Login to Access Quiz</h1>
        <div class="form-group">
            <label for="username">Username:</label>
            <input type="text" id="username" placeholder="Enter username" required>
        </div>
        <div class="form-group">
            <label for="login-password">Password:</label>
            <input type="password" id="login-password" placeholder="Enter password" required>
        </div>
        <button onclick="checkLogin()">Login</button>
        <p id="login-error" class="hidden">Incorrect username or password. Please try again.</p>
    </div>

    <div id="quiz-form" class="hidden">
        <h1>MCIE 1012 Chapter 5 Quiz</h1> <!-- Changed Header -->
        <form id="mcie-quiz-ch5" method="POST"> <!-- Changed ID -->
            <!-- Student Information -->
            <div class="form-group">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="id_number">ID Number:</label>
                <input type="text" id="id_number" name="id_number" required>
            </div>
            <div class="form-group">
                <label for="section">Section:</label>
                <input type="text" id="section" name="section" required>
            </div>
            <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required>
            </div>
            <div class="form-group">
                <label for="phone">Phone Number:</label>
                <input type="tel" id="phone" name="phone" required>
            </div>

            <hr>
            <h2>Chapter 5 Questions</h2>

            <!-- MCIE Chapter 5 Multiple-Choice Questions -->
            <div class="form-group">
                <label>1. What is the primary purpose of a constitution?</label>
                <input type="radio" name="q1" value="A" required><span>A) To establish a monarchy</span><br>
                <input type="radio" name="q1" value="B"><span>B) To limit governmental power and protect citizens' rights</span><br>
                <input type="radio" name="q1" value="C"><span>C) To centralize power in the executive branch</span><br>
                <input type="radio" name="q1" value="D"><span>D) To abolish all laws</span>
            </div>
            <div class="form-group">
                <label>2. Which of the following is NOT a peculiar feature of a constitution?</label>
                <input type="radio" name="q2" value="A" required><span>A) Supremacy</span><br>
                <input type="radio" name="q2" value="B"><span>B) Flexibility</span><br>
                <input type="radio" name="q2" value="C"><span>C) Written form</span><br>
                <input type="radio" name="q2" value="D"><span>D) Temporary nature</span>
            </div>
            <div class="form-group">
                <label>3. How are constitutions classified based on their form?</label>
                <input type="radio" name="q3" value="A" required><span>A) Written and unwritten</span><br>
                <input type="radio" name="q3" value="B"><span>B) Federal and unitary</span><br>
                <input type="radio" name="q3" value="C"><span>C) Democratic and authoritarian</span><br>
                <input type="radio" name="q3" value="D"><span>D) Rigid and flexible</span>
            </div>
            <div class="form-group">
                <label>4. What does constitutionalism emphasize?</label>
                <input type="radio" name="q4" value="A" required><span>A) Unlimited governmental power</span><br>
                <input type="radio" name="q4" value="B"><span>B) The rule of law and limited government</span><br>
                <input type="radio" name="q4" value="C"><span>C) The supremacy of the military</span><br>
                <input type="radio" name="q4" value="D"><span>D) The abolition of human rights</span>
            </div>
            <div class="form-group">
                <label>5. Which of the following is a major function of a constitution?</label>
                <input type="radio" name="q5" value="A" required><span>A) To promote dictatorship</span><br>
                <input type="radio" name="q5" value="B"><span>B) To define the structure and powers of government</span><br>
                <input type="radio" name="q5" value="C"><span>C) To eliminate elections</span><br>
                <input type="radio" name="q5" value="D"><span>D) To favor one political party</span>
            </div>
            <div class="form-group">
                <label>6. When was Ethiopia's first written constitution enacted?</label> <!-- Corrected -->
                <input type="radio" name="q6" value="A" required><span>A) 1955</span><br>
                <input type="radio" name="q6" value="B"><span>B) 1931</span><br>
                <input type="radio" name="q6" value="C"><span>C) 1987</span><br>
                <input type="radio" name="q6" value="D"><span>D) 1995</span>
            </div>
            <div class="form-group">
                <label>7. Which Ethiopian constitution introduced a Marxist-Leninist framework?</label>
                <input type="radio" name="q7" value="A" required><span>A) 1931 Constitution</span><br>
                <input type="radio" name="q7" value="B"><span>B) 1955 Revised Constitution</span><br>
                <input type="radio" name="q7" value="C"><span>C) 1987 PDRE Constitution</span><br>
                <input type="radio" name="q7" value="D"><span>D) 1995 FDRE Constitution</span>
            </div>
            <div class="form-group">
                <label>8. The 1995 FDRE Constitution is notable for:</label>
                <input type="radio" name="q8" value="A" required><span>A) Establishing a monarchy</span><br>
                <input type="radio" name="q8" value="B"><span>B) Recognizing human rights and federalism</span><br>
                <input type="radio" name="q8" value="C"><span>C) Abolishing elections</span><br>
                <input type="radio" name="q8" value="D"><span>D) Centralizing power</span>
            </div>
            <div class="form-group">
                <label>9. What was a key feature of Ethiopia's traditional constitution before 1931?</label> <!-- Corrected -->
                <input type="radio" name="q9" value="A" required><span>A) Written laws</span><br>
                <input type="radio" name="q9" value="B"><span>B) Customary and unwritten practices</span><br>
                <input type="radio" name="q9" value="C"><span>C) A parliamentary system</span><br>
                <input type="radio" name="q9" value="D"><span>D) A federal structure</span>
            </div>
            <div class="form-group">
                <label>10. Which constitution marked Ethiopia's transition to a federal democratic republic?</label> <!-- Corrected -->
                <input type="radio" name="q10" value="A" required><span>A) 1931 Constitution</span><br>
                <input type="radio" name="q10" value="B"><span>B) 1955 Revised Constitution</span><br>
                <input type="radio" name="q10" value="C"><span>C) 1987 PDRE Constitution</span><br>
                <input type="radio" name="q10" value="D"><span>D) 1995 FDRE Constitution</span>
            </div>
            <div class="form-group">
                <label>11. How is democracy primarily defined?</label>
                <input type="radio" name="q11" value="A" required><span>A) Rule by a single leader</span><br>
                <input type="radio" name="q11" value="B"><span>B) Government by the people, either directly or through representatives</span><br>
                <input type="radio" name="q11" value="C"><span>C) A system with no elections</span><br>
                <input type="radio" name="q11" value="D"><span>D) Rule by the military</span>
            </div>
            <div class="form-group">
                <label>12. Which of the following is NOT a value or principle of democracy?</label>
                <input type="radio" name="q12" value="A" required><span>A) Equality</span><br>
                <input type="radio" name="q12" value="B"><span>B) Rule of law</span><br>
                <input type="radio" name="q12" value="C"><span>C) Authoritarianism</span><br>
                <input type="radio" name="q12" value="D"><span>D) Accountability</span>
            </div>
            <div class="form-group">
                <label>13. What does democratization refer to?</label>
                <input type="radio" name="q13" value="A" required><span>A) The establishment of a monarchy</span><br>
                <input type="radio" name="q13" value="B"><span>B) The transition from nondemocratic to democratic regimes</span><br>
                <input type="radio" name="q13" value="C"><span>C) The elimination of political parties</span><br>
                <input type="radio" name="q13" value="D"><span>D) The centralization of power</span>
            </div>
            <div class="form-group">
                <label>14. Which actor is considered central to modern democracy?</label>
                <input type="radio" name="q14" value="A" required><span>A) Political parties</span><br>
                <input type="radio" name="q14" value="B"><span>B) Monarchs</span><br>
                <input type="radio" name="q14" value="C"><span>C) Military forces</span><br>
                <input type="radio" name="q14" value="D"><span>D) Religious leaders</span>
            </div>
            <div class="form-group">
                <label>15. What role does the media play in democratization?</label>
                <input type="radio" name="q15" value="A" required><span>A) Suppressing public opinion</span><br>
                <input type="radio" name="q15" value="B"><span>B) Acting as a watchdog and informing citizens</span><br>
                <input type="radio" name="q15" value="C"><span>C) Eliminating political parties</span><br>
                <input type="radio" name="q15" value="D"><span>D) Supporting authoritarian regimes</span>
            </div>
            <div class="form-group">
                <label>16. Civil society is vital for democracy because it:</label>
                <input type="radio" name="q16" value="A" required><span>A) Limits state power and promotes accountability</span><br>
                <input type="radio" name="q16" value="B"><span>B) Centralizes authority</span><br>
                <input type="radio" name="q16" value="C"><span>C) Prevents elections</span><br>
                <input type="radio" name="q16" value="D"><span>D) Supports military rule</span>
            </div>
            <div class="form-group">
                <label>17. Which of the following is a key element of democratization?</label>
                <input type="radio" name="q17" value="A" required><span>A) Consolidation of authoritarian rule</span><br>
                <input type="radio" name="q17" value="B"><span>B) Installation of a democratic regime</span><br>
                <input type="radio" name="q17" value="C"><span>C) Elimination of civil society</span><br>
                <input type="radio" name="q17" value="D"><span>D) Suppression of human rights</span>
            </div>
            <div class="form-group">
                <label>18. What is the primary function of political parties in a democracy?</label>
                <input type="radio" name="q18" value="A" required><span>A) To suppress opposition</span><br>
                <input type="radio" name="q18" value="B"><span>B) To bridge society and government</span><br>
                <input type="radio" name="q18" value="C"><span>C) To abolish elections</span><br>
                <input type="radio" name="q18" value="D"><span>D) To centralize power</span>
            </div>
            <div class="form-group">
                <label>19. Which principle ensures that elections are conducted periodically?</label>
                <input type="radio" name="q19" value="A" required><span>A) Free and fair elections</span><br>
                <input type="radio" name="q19" value="B"><span>B) Majority rule</span><br>
                <input type="radio" name="q19" value="C"><span>C) Separation of powers</span><br>
                <input type="radio" name="q19" value="D"><span>D) Rule of law</span>
            </div>
            <div class="form-group">
                <label>20. What is a characteristic of a participant political culture?</label>
                <input type="radio" name="q20" value="A" required><span>A) Low citizen engagement</span><br>
                <input type="radio" name="q20" value="B"><span>B) High cognitive and active participation in politics</span><br>
                <input type="radio" name="q20" value="C"><span>C) Passive acceptance of authority</span><br>
                <input type="radio" name="q20" value="D"><span>D) Rejection of democracy</span>
            </div>
             <div class="form-group">
                <label>21. Human rights are defined as:</label>
                <input type="radio" name="q21" value="A" required><span>A) Privileges granted by governments</span><br>
                <input type="radio" name="q21" value="B"><span>B) Entitlements inherent to all humans by virtue of being human</span><br>
                <input type="radio" name="q21" value="C"><span>C) Rights exclusive to certain groups</span><br>
                <input type="radio" name="q21" value="D"><span>D) Temporary benefits</span>
            </div>
            <div class="form-group">
                <label>22. Which principle of human rights states that they cannot be taken away?</label>
                <input type="radio" name="q22" value="A" required><span>A) Universality</span><br>
                <input type="radio" name="q22" value="B"><span>B) Inalienability</span><br>
                <input type="radio" name="q22" value="C"><span>C) Indivisibility</span><br>
                <input type="radio" name="q22" value="D"><span>D) Interdependence</span>
            </div>
            <div class="form-group">
                <label>23. The UDHR states that human rights apply:</label>
                <input type="radio" name="q23" value="A" required><span>A) Only to citizens of democratic countries</span><br>
                <input type="radio" name="q23" value="B"><span>B) Without distinction of race, color, sex, or other status</span><br>
                <input type="radio" name="q23" value="C"><span>C) Only to adults</span><br>
                <input type="radio" name="q23" value="D"><span>D) Based on economic status</span>
            </div>
            <div class="form-group">
                <label>24. What is the primary duty bearer for human rights?</label>
                <input type="radio" name="q24" value="A" required><span>A) Individuals</span><br>
                <input type="radio" name="q24" value="B"><span>B) The state</span><br>
                <input type="radio" name="q24" value="C"><span>C) Private corporations</span><br>
                <input type="radio" name="q24" value="D"><span>D) Religious institutions</span>
            </div>
            <div class="form-group">
                <label>25. Which of the following is an example of a civil right?</label>
                <input type="radio" name="q25" value="A" required><span>A) Right to education</span><br>
                <input type="radio" name="q25" value="B"><span>B) Right to a fair trial</span><br>
                <input type="radio" name="q25" value="C"><span>C) Right to development</span><br>
                <input type="radio" name="q25" value="D"><span>D) Right to health</span>
            </div>
            <div class="form-group">
                <label>26. Economic and social rights are often described as:</label>
                <input type="radio" name="q26" value="A" required><span>A) Negative rights</span><br>
                <input type="radio" name="q26" value="B"><span>B) Immediately realizable</span><br>
                <input type="radio" name="q26" value="C"><span>C) Positive rights requiring progressive implementation</span><br>
                <input type="radio" name="q26" value="D"><span>D) Non-justiciable</span>
            </div>
            <div class="form-group">
                <label>27. Third-generation rights are also known as:</label>
                <input type="radio" name="q27" value="A" required><span>A) Solidarity rights</span><br>
                <input type="radio" name="q27" value="B"><span>B) Civil rights</span><br>
                <input type="radio" name="q27" value="C"><span>C) Political rights</span><br>
                <input type="radio" name="q27" value="D"><span>D) Individual rights</span>
            </div>
            <div class="form-group">
                <label>28. Which right is considered a third-generation right?</label>
                <input type="radio" name="q28" value="A" required><span>A) Right to life</span><br>
                <input type="radio" name="q28" value="B"><span>B) Right to peace</span><br>
                <input type="radio" name="q28" value="C"><span>C) Right to free speech</span><br>
                <input type="radio" name="q28" value="D"><span>D) Right to privacy</span>
            </div>
            <div class="form-group">
                <label>29. What does the principle of interdependence of human rights imply?</label>
                <input type="radio" name="q29" value="A" required><span>A) Rights can be enjoyed independently</span><br>
                <input type="radio" name="q29" value="B"><span>B) The fulfillment of one right depends on others</span><br>
                <input type="radio" name="q29" value="C"><span>C) Some rights are more important than others</span><br>
                <input type="radio" name="q29" value="D"><span>D) Rights are optional</span>
            </div>
            <div class="form-group">
                <label>30. Which of the following is a non-derogable right under the ICCPR?</label>
                <input type="radio" name="q30" value="A" required><span>A) Freedom of assembly</span><br>
                <input type="radio" name="q30" value="B"><span>B) Freedom from torture</span><br>
                <input type="radio" name="q30" value="C"><span>C) Right to education</span><br>
                <input type="radio" name="q30" value="D"><span>D) Right to work</span>
            </div>
            <div class="form-group">
                <label>31. Under the FDRE Constitution, which right is non-derogable?</label>
                <input type="radio" name="q31" value="A" required><span>A) Right to property</span><br>
                <input type="radio" name="q31" value="B"><span>B) Right to equality (Article 25)</span><br>
                <input type="radio" name="q31" value="C"><span>C) Right to education</span><br>
                <input type="radio" name="q31" value="D"><span>D) Right to free movement</span>
            </div>
            <div class="form-group">
                <label>32. What is the purpose of derogation in human rights?</label>
                <input type="radio" name="q32" value="A" required><span>A) To permanently suspend rights</span><br>
                <input type="radio" name="q32" value="B"><span>B) To temporarily suspend rights during emergencies</span><br>
                <input type="radio" name="q32" value="C"><span>C) To grant new rights</span><br>
                <input type="radio" name="q32" value="D"><span>D) To limit state power</span>
            </div>
            <div class="form-group">
                <label>33. Limitations on human rights must be:</label>
                <input type="radio" name="q33" value="A" required><span>A) Arbitrary</span><br>
                <input type="radio" name="q33" value="B"><span>B) Based on legality, necessity, and proportionality</span><br>
                <input type="radio" name="q33" value="C"><span>C) Permanent</span><br>
                <input type="radio" name="q33" value="D"><span>D) Unregulated</span>
            </div>
            <div class="form-group">
                <label>34. Which international document is considered the foundation of modern human rights?</label>
                <input type="radio" name="q34" value="A" required><span>A) UN Charter</span><br>
                <input type="radio" name="q34" value="B"><span>B) Universal Declaration of Human Rights (UDHR)</span><br>
                <input type="radio" name="q34" value="C"><span>C) ICCPR</span><br>
                <input type="radio" name="q34" value="D"><span>D) CEDAW</span>
            </div>
            <div class="form-group">
                <label>35. The International Bill of Human Rights includes:</label>
                <input type="radio" name="q35" value="A" required><span>A) UDHR, ICCPR, and ICESCR</span><br>
                <input type="radio" name="q35" value="B"><span>B) UN Charter and UDHR</span><br>
                <input type="radio" name="q35" value="C"><span>C) ICCPR and CEDAW</span><br>
                <input type="radio" name="q35" value="D"><span>D) UDHR and CRC</span>
            </div>
            <div class="form-group">
                <label>36. Which UN organ is specifically dedicated to human rights?</label>
                <input type="radio" name="q36" value="A" required><span>A) Security Council</span><br>
                <input type="radio" name="q36" value="B"><span>B) Office of the High Commissioner for Human Rights (OHCHR)</span><br>
                <input type="radio" name="q36" value="C"><span>C) General Assembly</span><br>
                <input type="radio" name="q36" value="D"><span>D) International Criminal Court</span>
            </div>
            <div class="form-group">
                <label>37. Ethiopia is a signatory to which regional human rights charter?</label>
                <input type="radio" name="q37" value="A" required><span>A) European Convention on Human Rights</span><br>
                <input type="radio" name="q37" value="B"><span>B) African Charter on Human and Peoples' Rights</span><br> <!-- Corrected -->
                <input type="radio" name="q37" value="C"><span>C) American Convention on Human Rights</span><br>
                <input type="radio" name="q37" value="D"><span>D) ASEAN Human Rights Declaration</span>
            </div>
            <div class="form-group">
                <label>38. What is the role of regional human rights systems?</label>
                <input type="radio" name="q38" value="A" required><span>A) To replace international systems</span><br>
                <input type="radio" name="q38" value="B"><span>B) To enforce human rights with regional context</span><br>
                <input type="radio" name="q38" value="C"><span>C) To abolish national laws</span><br>
                <input type="radio" name="q38" value="D"><span>D) To centralize global authority</span>
            </div>
            <div class="form-group">
                <label>39. The Ethiopian Human Rights Commission (EHRC) is established to:</label>
                <input type="radio" name="q39" value="A" required><span>A) Promote and protect human rights</span><br>
                <input type="radio" name="q39" value="B"><span>B) Enforce military rule</span><br>
                <input type="radio" name="q39" value="C"><span>C) Limit constitutional rights</span><br>
                <input type="radio" name="q39" value="D"><span>D) Abolish elections</span>
            </div>
            <div class="form-group">
                <label>40. Which article of the FDRE Constitution emphasizes the supremacy of international human rights instruments?</label>
                <input type="radio" name="q40" value="A" required><span>A) Article 9</span><br>
                <input type="radio" name="q40" value="B"><span>B) Article 13</span><br>
                <input type="radio" name="q40" value="C"><span>C) Article 25</span><br>
                <input type="radio" name="q40" value="D"><span>D) Article 39</span>
            </div>
            <div class="form-group">
                <label>41. What is a key feature of civil and political rights?</label>
                <input type="radio" name="q41" value="A" required><span>A) They require progressive realization</span><br>
                <input type="radio" name="q41" value="B"><span>B) They are immediately realizable</span><br>
                <input type="radio" name="q41" value="C"><span>C) They focus on economic development</span><br>
                <input type="radio" name="q41" value="D"><span>D) They are collective rights</span>
            </div>
            <div class="form-group">
                <label>42. The right to development is classified as:</label>
                <input type="radio" name="q42" value="A" required><span>A) A first-generation right</span><br>
                <input type="radio" name="q42" value="B"><span>B) A second-generation right</span><br>
                <input type="radio" name="q42" value="C"><span>C) A third-generation right</span><br>
                <input type="radio" name="q42" value="D"><span>D) A non-human right</span>
            </div>
            <div class="form-group">
                <label>43. Which of the following is a duty of citizens related to human rights?</label>
                <input type="radio" name="q43" value="A" required><span>A) Ignoring the rights of others</span><br>
                <input type="radio" name="q43" value="B"><span>B) Exercising rights with regard for others' rights</span><br> <!-- Corrected -->
                <input type="radio" name="q43" value="C"><span>C) Abolishing human rights</span><br>
                <input type="radio" name="q43" value="D"><span>D) Limiting state power</span>
            </div>
            <div class="form-group">
                <label>44. What is the purpose of the separation of powers in a democracy?</label>
                <input type="radio" name="q44" value="A" required><span>A) To concentrate power in one branch</span><br>
                <input type="radio" name="q44" value="B"><span>B) To promote accountability and prevent corruption</span><br>
                <input type="radio" name="q44" value="C"><span>C) To eliminate judicial oversight</span><br>
                <input type="radio" name="q44" value="D"><span>D) To favor the executive branch</span>
            </div>
            <div class="form-group">
                <label>45. Which of the following is a condition for declaring a state of emergency under the FDRE Constitution?</label>
                <input type="radio" name="q45" value="A" required><span>A) Economic growth</span><br>
                <input type="radio" name="q45" value="B"><span>B) External invasion</span><br>
                <input type="radio" name="q45" value="C"><span>C) Political party disputes</span><br>
                <input type="radio" name="q45" value="D"><span>D) Media censorship</span>
            </div>
            <div class="form-group">
                <label>46. The media's role as a 'civic forum' refers to:</label> <!-- Corrected quotes -->
                <input type="radio" name="q46" value="A" required><span>A) Suppressing public debate</span><br>
                <input type="radio" name="q46" value="B"><span>B) Providing a platform for public discussion</span><br>
                <input type="radio" name="q46" value="C"><span>C) Limiting information access</span><br>
                <input type="radio" name="q46" value="D"><span>D) Supporting authoritarianism</span>
            </div>
            <div class="form-group">
                <label>47. What does the principle of 'majority rule, minority right' ensure?</label> <!-- Corrected quotes -->
                <input type="radio" name="q47" value="A" required><span>A) Minority groups are excluded</span><br>
                <input type="radio" name="q47" value="B"><span>B) Majority governs while minority rights are protected</span><br>
                <input type="radio" name="q47" value="C"><span>C) Only the majority has rights</span><br>
                <input type="radio" name="q47" value="D"><span>D) Minority rules over the majority</span>
            </div>
            <div class="form-group">
                <label>48. Which human rights category includes the right to health?</label>
                <input type="radio" name="q48" value="A" required><span>A) Civil and political rights</span><br>
                <input type="radio" name="q48" value="B"><span>B) Economic and social rights</span><br>
                <input type="radio" name="q48" value="C"><span>C) Solidarity rights</span><br>
                <input type="radio" name="q48" value="D"><span>D) Individual rights</span>
            </div>
            <div class="form-group">
                <label>49. The FDRE Constitution dedicates which chapter to human rights?</label>
                <input type="radio" name="q49" value="A" required><span>A) Chapter 1</span><br>
                <input type="radio" name="q49" value="B"><span>B) Chapter 3</span><br>
                <input type="radio" name="q49" value="C"><span>C) Chapter 5</span><br>
                <input type="radio" name="q49" value="D"><span>D) Chapter 11</span>
            </div>
            <div class="form-group">
                <label>50. What is a key challenge to the justiciability of economic and social rights?</label>
                <input type="radio" name="q50" value="A" required><span>A) They are immediately enforceable</span><br>
                <input type="radio" name="q50" value="B"><span>B) They depend on state resources and capacity</span><br>
                <input type="radio" name="q50" value="C"><span>C) They are non-derogable</span><br>
                <input type="radio" name="q50" value="D"><span>D) They are universally rejected</span>
            </div>


            <button type="button" onclick="showReview()">Submit</button>
        </form>
        <div id="error-message" class="hidden">
            <p>Something went wrong. Please try again.</p>
        </div>
    </div>

    <!-- ... Rest of the HTML (review, submission, password, results divs) remains the same ... -->
     <div id="review-section" class="hidden">
        <h2>Review Your Answers</h2>
        <div id="review-content"></div>
        <button onclick="editForm()">Edit</button>
        <button onclick="downloadResponse()" id="download-response">Download My Response</button>
        <button onclick="confirmSubmission()">Confirm Submission</button>
    </div>

    <div id="submission-copy" class="hidden">
        <h2>Your Submitted Answers</h2>
        <div id="submission-content"></div>
        <button onclick="proceedToPassword()">Proceed</button>
    </div>

    <div id="password-section" class="hidden">
        <h1 id="success-message">Your response has been submitted</h1>
        <p>You can view your result (score) by entering the password.</p>
        <input type="password" id="password" placeholder="Enter password">
        <button onclick="checkPassword()">Submit</button>
        <p id="password-error" class="hidden">Incorrect password. Please try again.</p>
    </div>

    <div id="results" class="hidden">
        <h1>Quiz Results</h1>
        <p id="student-info"></p>
        <div id="answers"></div>
        <p id="score"></p>
        <button id="download-pdf" onclick="downloadPDF()">Download Results PDF</button>
    </div>


    <script>
        let quizData = null;
        let formData = null;
        const { jsPDF } = window.jspdf;
        const TOTAL_QUESTIONS = 50; // Updated Total number of questions for Ch5

        // Valid login credentials
        const validCredentials = [
            { username: 'section19', password: '123' },
            { username: 'section20', password: '123' },
            { username: 'muzemuza', password: 'moh' },
            { username: 'section21', password: '123' }
            // Add more valid credentials as needed
        ];

        // Structure holding question texts and choices for Chapter 5
        // Corrected apostrophes (') where needed (Q2, Q6, Q9, Q10, Q30, Q37, Q43, Q46, Q47)
        const allQuestionsData = {
            q1: { text: "What is the primary purpose of a constitution?", choices: { A: "To establish a monarchy", B: "To limit governmental power and protect citizens' rights", C: "To centralize power in the executive branch", D: "To abolish all laws" } },
            q2: { text: "Which of the following is NOT a peculiar feature of a constitution?", choices: { A: "Supremacy", B: "Flexibility", C: "Written form", D: "Temporary nature" } }, // Corrected 's in choice B
            q3: { text: "How are constitutions classified based on their form?", choices: { A: "Written and unwritten", B: "Federal and unitary", C: "Democratic and authoritarian", D: "Rigid and flexible" } },
            q4: { text: "What does constitutionalism emphasize?", choices: { A: "Unlimited governmental power", B: "The rule of law and limited government", C: "The supremacy of the military", D: "The abolition of human rights" } },
            q5: { text: "Which of the following is a major function of a constitution?", choices: { A: "To promote dictatorship", B: "To define the structure and powers of government", C: "To eliminate elections", D: "To favor one political party" } },
            q6: { text: "When was Ethiopia's first written constitution enacted?", choices: { A: "1955", B: "1931", C: "1987", D: "1995" } }, // Corrected 's
            q7: { text: "Which Ethiopian constitution introduced a Marxist-Leninist framework?", choices: { A: "1931 Constitution", B: "1955 Revised Constitution", C: "1987 PDRE Constitution", D: "1995 FDRE Constitution" } },
            q8: { text: "The 1995 FDRE Constitution is notable for:", choices: { A: "Establishing a monarchy", B: "Recognizing human rights and federalism", C: "Abolishing elections", D: "Centralizing power" } },
            q9: { text: "What was a key feature of Ethiopia's traditional constitution before 1931?", choices: { A: "Written laws", B: "Customary and unwritten practices", C: "A parliamentary system", D: "A federal structure" } }, // Corrected 's
            q10: { text: "Which constitution marked Ethiopia's transition to a federal democratic republic?", choices: { A: "1931 Constitution", B: "1955 Revised Constitution", C: "1987 PDRE Constitution", D: "1995 FDRE Constitution" } }, // Corrected 's
            q11: { text: "How is democracy primarily defined?", choices: { A: "Rule by a single leader", B: "Government by the people, either directly or through representatives", C: "A system with no elections", D: "Rule by the military" } },
            q12: { text: "Which of the following is NOT a value or principle of democracy?", choices: { A: "Equality", B: "Rule of law", C: "Authoritarianism", D: "Accountability" } },
            q13: { text: "What does democratization refer to?", choices: { A: "The establishment of a monarchy", B: "The transition from nondemocratic to democratic regimes", C: "The elimination of political parties", D: "The centralization of power" } },
            q14: { text: "Which actor is considered central to modern democracy?", choices: { A: "Political parties", B: "Monarchs", C: "Military forces", D: "Religious leaders" } },
            q15: { text: "What role does the media play in democratization?", choices: { A: "Suppressing public opinion", B: "Acting as a watchdog and informing citizens", C: "Eliminating political parties", D: "Supporting authoritarian regimes" } },
            q16: { text: "Civil society is vital for democracy because it:", choices: { A: "Limits state power and promotes accountability", B: "Centralizes authority", C: "Prevents elections", D: "Supports military rule" } },
            q17: { text: "Which of the following is a key element of democratization?", choices: { A: "Consolidation of authoritarian rule", B: "Installation of a democratic regime", C: "Elimination of civil society", D: "Suppression of human rights" } },
            q18: { text: "What is the primary function of political parties in a democracy?", choices: { A: "To suppress opposition", B: "To bridge society and government", C: "To abolish elections", D: "To centralize power" } },
            q19: { text: "Which principle ensures that elections are conducted periodically?", choices: { A: "Free and fair elections", B: "Majority rule", C: "Separation of powers", D: "Rule of law" } },
            q20: { text: "What is a characteristic of a participant political culture?", choices: { A: "Low citizen engagement", B: "High cognitive and active participation in politics", C: "Passive acceptance of authority", D: "Rejection of democracy" } },
            q21: { text: "Human rights are defined as:", choices: { A: "Privileges granted by governments", B: "Entitlements inherent to all humans by virtue of being human", C: "Rights exclusive to certain groups", D: "Temporary benefits" } },
            q22: { text: "Which principle of human rights states that they cannot be taken away?", choices: { A: "Universality", B: "Inalienability", C: "Indivisibility", D: "Interdependence" } },
            q23: { text: "The UDHR states that human rights apply:", choices: { A: "Only to citizens of democratic countries", B: "Without distinction of race, color, sex, or other status", C: "Only to adults", D: "Based on economic status" } },
            q24: { text: "What is the primary duty bearer for human rights?", choices: { A: "Individuals", B: "The state", C: "Private corporations", D: "Religious institutions" } },
            q25: { text: "Which of the following is an example of a civil right?", choices: { A: "Right to education", B: "Right to a fair trial", C: "Right to development", D: "Right to health" } },
            q26: { text: "Economic and social rights are often described as:", choices: { A: "Negative rights", B: "Immediately realizable", C: "Positive rights requiring progressive implementation", D: "Non-justiciable" } },
            q27: { text: "Third-generation rights are also known as:", choices: { A: "Solidarity rights", B: "Civil rights", C: "Political rights", D: "Individual rights" } },
            q28: { text: "Which right is considered a third-generation right?", choices: { A: "Right to life", B: "Right to peace", C: "Right to free speech", D: "Right to privacy" } },
            q29: { text: "What does the principle of interdependence of human rights imply?", choices: { A: "Rights can be enjoyed independently", B: "The fulfillment of one right depends on others", C: "Some rights are more important than others", D: "Rights are optional" } },
            q30: { text: "Which of the following is a non-derogable right under the ICCPR?", choices: { A: "Freedom of assembly", B: "Freedom from torture", C: "Right to education", D: "Right to work" } },
            q31: { text: "Under the FDRE Constitution, which right is non-derogable?", choices: { A: "Right to property", B: "Right to equality (Article 25)", C: "Right to education", D: "Right to free movement" } },
            q32: { text: "What is the purpose of derogation in human rights?", choices: { A: "To permanently suspend rights", B: "To temporarily suspend rights during emergencies", C: "To grant new rights", D: "To limit state power" } },
            q33: { text: "Limitations on human rights must be:", choices: { A: "Arbitrary", B: "Based on legality, necessity, and proportionality", C: "Permanent", D: "Unregulated" } },
            q34: { text: "Which international document is considered the foundation of modern human rights?", choices: { A: "UN Charter", B: "Universal Declaration of Human Rights (UDHR)", C: "ICCPR", D: "CEDAW" } },
            q35: { text: "The International Bill of Human Rights includes:", choices: { A: "UDHR, ICCPR, and ICESCR", B: "UN Charter and UDHR", C: "ICCPR and CEDAW", D: "UDHR and CRC" } },
            q36: { text: "Which UN organ is specifically dedicated to human rights?", choices: { A: "Security Council", B: "Office of the High Commissioner for Human Rights (OHCHR)", C: "General Assembly", D: "International Criminal Court" } },
            q37: { text: "Ethiopia is a signatory to which regional human rights charter?", choices: { A: "European Convention on Human Rights", B: "African Charter on Human and Peoples\\' Rights", C: "American Convention on Human Rights", D: "ASEAN Human Rights Declaration" } }, // Corrected 's
            q38: { text: "What is the role of regional human rights systems?", choices: { A: "To replace international systems", B: "To enforce human rights with regional context", C: "To abolish national laws", D: "To centralize global authority" } },
            q39: { text: "The Ethiopian Human Rights Commission (EHRC) is established to:", choices: { A: "Promote and protect human rights", B: "Enforce military rule", C: "Limit constitutional rights", D: "Abolish elections" } },
            q40: { text: "Which article of the FDRE Constitution emphasizes the supremacy of international human rights instruments?", choices: { A: "Article 9", B: "Article 13", C: "Article 25", D: "Article 39" } },
            q41: { text: "What is a key feature of civil and political rights?", choices: { A: "They require progressive realization", B: "They are immediately realizable", C: "They focus on economic development", D: "They are collective rights" } },
            q42: { text: "The right to development is classified as:", choices: { A: "A first-generation right", B: "A second-generation right", C: "A third-generation right", D: "A non-human right" } },
            q43: { text: "Which of the following is a duty of citizens related to human rights?", choices: { A: "Ignoring the rights of others", B: "Exercising rights with regard for others\\' rights", C: "Abolishing human rights", D: "Limiting state power" } }, // Corrected 's
            q44: { text: "What is the purpose of the separation of powers in a democracy?", choices: { A: "To concentrate power in one branch", B: "To promote accountability and prevent corruption", C: "To eliminate judicial oversight", D: "To favor the executive branch" } },
            q45: { text: "Which of the following is a condition for declaring a state of emergency under the FDRE Constitution?", choices: { A: "Economic growth", B: "External invasion", C: "Political party disputes", D: "Media censorship" } },
            q46: { text: "The media's role as a 'civic forum' refers to:", choices: { A: "Suppressing public debate", B: "Providing a platform for public discussion", C: "Limiting information access", D: "Supporting authoritarianism" } }, // Corrected quotes
            q47: { text: "What does the principle of 'majority rule, minority right' ensure?", choices: { A: "Minority groups are excluded", B: "Majority governs while minority rights are protected", C: "Only the majority has rights", D: "Minority rules over the majority" } }, // Corrected quotes
            q48: { text: "Which human rights category includes the right to health?", choices: { A: "Civil and political rights", B: "Economic and social rights", C: "Solidarity rights", D: "Individual rights" } },
            q49: { text: "The FDRE Constitution dedicates which chapter to human rights?", choices: { A: "Chapter 1", B: "Chapter 3", C: "Chapter 5", D: "Chapter 11" } },
            q50: { text: "What is a key challenge to the justiciability of economic and social rights?", choices: { A: "They are immediately enforceable", B: "They depend on state resources and capacity", C: "They are non-derogable", D: "They are universally rejected" } }
        };

        // Correct answers mapped to letters for Chapter 5
        const correctAnswersMap = {
             q1: 'B',  q2: 'D',  q3: 'A',  q4: 'B',  q5: 'B',
             q6: 'B',  q7: 'C',  q8: 'B',  q9: 'B', q10: 'D',
            q11: 'B', q12: 'C', q13: 'B', q14: 'A', q15: 'B',
            q16: 'A', q17: 'B', q18: 'B', q19: 'A', q20: 'B',
            q21: 'B', q22: 'B', q23: 'B', q24: 'B', q25: 'B',
            q26: 'C', q27: 'A', q28: 'B', q29: 'B', q30: 'B',
            q31: 'B', q32: 'B', q33: 'B', q34: 'B', q35: 'A',
            q36: 'B', q37: 'B', q38: 'B', q39: 'A', q40: 'B',
            q41: 'B', q42: 'C', q43: 'B', q44: 'B', q45: 'B',
            q46: 'B', q47: 'B', q48: 'B', q49: 'B', q50: 'B'
        };


        // --- Functions (checkLogin, showReview, editForm, downloadResponse, confirmSubmission, etc.) ---
        // No changes needed in the function logic itself.

        function checkLogin() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('login-password').value.trim();
            const errorMessage = document.getElementById('login-error');
            const loginSection = document.getElementById('login-section');
            const quizForm = document.getElementById('quiz-form');

            const isValid = validCredentials.some(cred =>
                cred.username === username && cred.password === password
            );

            if (isValid) {
                errorMessage.classList.add('hidden');
                loginSection.classList.add('hidden');
                quizForm.classList.remove('hidden');
            } else {
                errorMessage.classList.remove('hidden');
            }
        }

        function showReview() {
            const form = document.getElementById('mcie-quiz-ch5'); // Ensure correct form ID
            formData = new FormData(form);
            const data = Object.fromEntries(formData);

             let allAnswered = true;
             for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 if (!data[`q${i}`]) {
                     allAnswered = false;
                     break;
                 }
             }

             if (!data.name || !data.id_number || !data.section || !data.email || !data.phone || !allAnswered) {
                 alert('Please fill in all personal information and answer all questions before submitting.');
                 return;
             }

            quizData = {
                name: data.name,
                id_number: data.id_number,
                section: data.section,
                email: data.email,
                phone: data.phone,
                answers: {},
                questions: allQuestionsData
            };

            let reviewHTML = `
                <p><strong>Name:</strong> ${data.name}</p>
                <p><strong>ID Number:</strong> ${data.id_number}</p>
                <p><strong>Section:</strong> ${data.section}</p>
                <p><strong>Email:</strong> ${data.email}</p>
                <p><strong>Phone Number:</strong> ${data.phone}</p>
                <hr>
                <h3>Your Answers:</h3>
            `;

            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                const qKey = `q${i}`;
                const userAnswer = data[qKey];
                 if (!userAnswer) {
                    quizData.answers[qKey] = 'Not Answered';
                    reviewHTML += `<p><strong>Question ${i}:</strong> ${allQuestionsData[qKey].text}<br>Your answer: Not Answered</p>`;
                 } else {
                    quizData.answers[qKey] = userAnswer;
                    const questionInfo = allQuestionsData[qKey];
                    const answerText = questionInfo.choices[userAnswer];
                    reviewHTML += `<p><strong>Question ${i}:</strong> ${questionInfo.text}<br>Your answer: ${userAnswer}) ${answerText}</p>`;
                 }
            }

            const reviewContent = document.getElementById('review-content');
            reviewContent.innerHTML = reviewHTML;

            document.getElementById('quiz-form').classList.add('hidden');
            document.getElementById('review-section').classList.remove('hidden');
        }

        function editForm() {
            document.getElementById('review-section').classList.add('hidden');
            document.getElementById('quiz-form').classList.remove('hidden');
        }

        function downloadResponse() {
            if (!quizData) return;

            const doc = new jsPDF();
            let y = 10;
            const pageHeight = doc.internal.pageSize.height;
            const margin = 10;
            const lineHeight = 7;
            const questionSpacing = 5;
            const answerSpacing = 10;

            doc.setFontSize(16);
            doc.text('MCIE Chapter 5 Quiz Response', margin, y); // Updated Title
            y += 10;

            doc.setFontSize(12);
            doc.text(`Name: ${quizData.name}`, margin, y); y += lineHeight;
            doc.text(`ID: ${quizData.id_number}`, margin, y); y += lineHeight;
            doc.text(`Section: ${quizData.section}`, margin, y); y += lineHeight;
            doc.text(`Email: ${quizData.email}`, margin, y); y += lineHeight;
            doc.text(`Phone: ${quizData.phone}`, margin, y); y += 10;

            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                const qKey = `q${i}`;
                const question = quizData.questions[qKey];
                const userAnswer = quizData.answers[qKey];
                const answerText = userAnswer !== 'Not Answered' ? question.choices[userAnswer] : 'Not Answered';

                const questionText = `Question ${i}: ${question.text}`;
                const questionLines = doc.splitTextToSize(questionText, doc.internal.pageSize.width - margin * 2);
                const neededHeight = (questionLines.length * 5) + questionSpacing + lineHeight + answerSpacing;

                 if (y + neededHeight > pageHeight - margin) {
                    doc.addPage();
                    y = margin;
                }

                doc.text(questionLines, margin, y);
                y += (questionLines.length * 5) + questionSpacing;

                 if (y > pageHeight - margin) { doc.addPage(); y = margin; }
                doc.text(`Your answer: ${userAnswer !== 'Not Answered' ? userAnswer + ') ' : ''}${answerText}`, margin, y);
                y += answerSpacing;
            }

            doc.save(`quiz_ch5_response_${quizData.id_number}.pdf`); // Updated filename
        }

        async function confirmSubmission() {
            if (confirm('Are you sure you want to submit your answers?')) {
                if (!quizData || !formData) {
                     console.error("Quiz data or form data is missing.");
                     alert("Error: Cannot submit. Please try filling the form again.");
                     editForm();
                     return;
                }

                const data = Object.fromEntries(formData);

                let score = 0;
                for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                    const qKey = `q${i}`;
                    if (data[qKey] && data[qKey] === correctAnswersMap[qKey]) {
                        score++;
                    }
                }
                quizData.score = score;

                 const answersForSubmission = {};
                 for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                     answersForSubmission[`q${i}`] = data[`q${i}`] || 'Not Answered';
                 }

                const submissionData = {
                    quizTitle: "MCIE Chapter 5 Quiz", // Updated Title
                    name: data.name,
                    id_number: data.id_number,
                    section: data.section,
                    email: data.email,
                    phone: data.phone,
                    ...answersForSubmission,
                    score: score,
                    totalQuestions: TOTAL_QUESTIONS,
                    submittedAt: new Date().toISOString()
                };

                try {
                    const response = await fetch('https://formspree.io/f/myzeoejq', { // Use your Formspree endpoint
                        method: 'POST',
                        body: JSON.stringify(submissionData),
                        headers: {
                            'Accept': 'application/json',
                            'Content-Type': 'application/json'
                        }
                    });

                    if (response.ok) {
                        const submissionContent = document.getElementById('submission-content');
                         let submissionHTML = `
                            <p><strong>Name:</strong> ${quizData.name}</p>
                            <p><strong>ID Number:</strong> ${quizData.id_number}</p>
                            <p><strong>Section:</strong> ${quizData.section}</p>
                            <p><strong>Email:</strong> ${quizData.email}</p>
                            <p><strong>Phone Number:</strong> ${quizData.phone}</p>
                            <hr>
                            <h3>Submitted Answers:</h3>
                        `;
                         for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                             const qKey = `q${i}`;
                             const questionInfo = quizData.questions[qKey];
                             const userAnswer = quizData.answers[qKey];
                             const answerText = userAnswer !== 'Not Answered' ? questionInfo.choices[userAnswer] : 'Not Answered';
                             submissionHTML += `<p><strong>Question ${i}:</strong> ${questionInfo.text}<br>Your answer: ${userAnswer !== 'Not Answered' ? userAnswer + ') ' : ''}${answerText}</p>`;
                         }
                        submissionContent.innerHTML = submissionHTML;

                        document.getElementById('review-section').classList.add('hidden');
                        document.getElementById('submission-copy').classList.remove('hidden');
                    } else {
                        const errorData = await response.json();
                        console.error('Formspree error:', errorData);
                        document.getElementById('error-message').innerHTML = `<p>Submission failed: ${errorData.error || 'Please try again.'}</p>`;
                        document.getElementById('error-message').classList.remove('hidden');
                        document.getElementById('review-section').classList.add('hidden');
                    }
                } catch (error) {
                    console.error('Submission error:', error);
                    document.getElementById('error-message').innerHTML = `<p>An network error occurred during submission. Please check your connection and try again.</p>`;
                    document.getElementById('error-message').classList.remove('hidden');
                    document.getElementById('review-section').classList.add('hidden');
                }
            }
        }

        function proceedToPassword() {
            document.getElementById('submission-copy').classList.add('hidden');
            document.getElementById('password-section').classList.remove('hidden');
        }

        function checkPassword() {
            const passwordInput = document.getElementById('password').value;
            const correctPassword = 'password';
            const errorMessage = document.getElementById('password-error');
            const passwordSection = document.getElementById('password-section');
            const results = document.getElementById('results');

            if (passwordInput === correctPassword) {
                errorMessage.classList.add('hidden');
                passwordSection.classList.add('hidden');
                results.classList.remove('hidden');
                displayResults();
            } else {
                errorMessage.classList.remove('hidden');
            }
        }

        function displayResults() {
            if (!quizData) {
                document.getElementById('results').innerHTML = '<p>Error: No quiz data found. Please complete the quiz first.</p>';
                return;
            }

             const displayCorrectAnswers = {};
             for(let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const correctLetter = correctAnswersMap[qKey];
                 const correctText = allQuestionsData[qKey] ? allQuestionsData[qKey].choices[correctLetter] : 'N/A';
                 displayCorrectAnswers[qKey] = `${correctLetter} (${correctText})`;
             }

            document.getElementById('student-info').innerHTML = `<strong>Name:</strong> ${quizData.name}<br><strong>ID:</strong> ${quizData.id_number}<br><strong>Section:</strong> ${quizData.section}<br><strong>Email:</strong> ${quizData.email}<br><strong>Phone:</strong> ${quizData.phone}`;

            const answersDiv = document.getElementById('answers');
            let answersHTML = '<h3>Detailed Results:</h3>';

            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const question = quizData.questions[qKey];
                 const userAnswer = quizData.answers[qKey];
                 const userAnswerText = userAnswer !== 'Not Answered' ? question.choices[userAnswer] : 'Not Answered';
                 const isCorrect = userAnswer === correctAnswersMap[qKey];

                 answersHTML += `
                    <div class="question-result">
                        <p><strong>Question ${i}:</strong> ${question.text}</p>
                        <div class="choices">
                            <p>A) ${question.choices.A}</p>
                            <p>B) ${question.choices.B}</p>
                            <p>C) ${question.choices.C}</p>
                            <p>D) ${question.choices.D}</p>
                        </div>
                        <p>Your answer: ${userAnswer !== 'Not Answered' ? userAnswer + ') ' : ''}${userAnswerText} ${isCorrect ? '<span style="color:green; font-weight:bold;">(Correct)</span>' : '<span style="color:red; font-weight:bold;">(Incorrect)</span>'}</p>
                        <p>Correct answer: ${displayCorrectAnswers[qKey]}</p>
                    </div>
                `;
            }
            answersDiv.innerHTML = answersHTML;

            document.getElementById('score').textContent = `Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`;
        }

        function downloadPDF() {
            if (!quizData) return;

            const doc = new jsPDF();
            let y = 10;
            const pageHeight = doc.internal.pageSize.height;
            const margin = 10;
            const lineHeight = 7;
            const questionSpacing = 5;
            const answerSpacing = 7;
            const questionBlockSpacing = 10;

             const displayCorrectAnswers = {};
             for(let i = 1; i <= TOTAL_QUESTIONS; i++) {
                 const qKey = `q${i}`;
                 const correctLetter = correctAnswersMap[qKey];
                 const correctText = allQuestionsData[qKey] ? allQuestionsData[qKey].choices[correctLetter] : 'N/A';
                 displayCorrectAnswers[qKey] = `${correctLetter} (${correctText})`;
             }

            doc.setFontSize(16);
            doc.text('MCIE Chapter 5 Quiz Results', doc.internal.pageSize.width / 2, y, { align: 'center' }); // Updated Title
            y += 10;

            doc.setFontSize(12);
            doc.text(`Name: ${quizData.name}`, margin, y); y += lineHeight;
            doc.text(`ID: ${quizData.id_number}`, margin, y); y += lineHeight;
            doc.text(`Section: ${quizData.section}`, margin, y); y += lineHeight;
            doc.text(`Email: ${quizData.email}`, margin, y); y += lineHeight;
            doc.text(`Phone: ${quizData.phone}`, margin, y); y += 10;

            doc.setFont('helvetica', 'bold');
            doc.text(`Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`, doc.internal.pageSize.width / 2, y, { align: 'center' });
            y += 10;
            doc.setFont('helvetica', 'normal');

            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                const qKey = `q${i}`;
                const question = quizData.questions[qKey];
                const userAnswer = quizData.answers[qKey];
                const userAnswerText = userAnswer !== 'Not Answered' ? question.choices[userAnswer] : 'Not Answered';
                const isCorrect = userAnswer === correctAnswersMap[qKey];

                const questionText = `Question ${i}: ${question.text}`;
                const questionLines = doc.splitTextToSize(questionText, doc.internal.pageSize.width - margin * 2);

                const choicesHeight = 4 * 5 + answerSpacing;
                const answerLinesHeight = 2 * lineHeight + questionBlockSpacing;
                const neededHeight = (questionLines.length * 5) + questionSpacing + choicesHeight + answerLinesHeight;

                if (y + neededHeight > pageHeight - margin) {
                    doc.addPage();
                    y = margin;
                }

                doc.setFont('helvetica', 'bold');
                doc.text(questionLines, margin, y);
                y += (questionLines.length * 5) + questionSpacing;
                doc.setFont('helvetica', 'normal');

                if (y + choicesHeight + answerLinesHeight > pageHeight - margin) { doc.addPage(); y = margin; }

                doc.text(`Choices:`, margin, y); y += 5;
                doc.text(`  A) ${question.choices.A}`, margin, y); y += 5;
                doc.text(`  B) ${question.choices.B}`, margin, y); y += 5;
                doc.text(`  C) ${question.choices.C}`, margin, y); y += 5;
                doc.text(`  D) ${question.choices.D}`, margin, y); y += answerSpacing;

                doc.text(`Your answer: ${userAnswer !== 'Not Answered' ? userAnswer + ') ' : ''}${userAnswerText} ${isCorrect ? '(Correct)' : '(Incorrect)'}`, margin, y); y += lineHeight;
                doc.text(`Correct answer: ${displayCorrectAnswers[qKey]}`, margin, y); y += questionBlockSpacing;
            }

            if (y > pageHeight - margin) { doc.addPage(); y = margin; }
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(14);
            doc.text(`Final Score: ${quizData.score} / ${TOTAL_QUESTIONS}`, doc.internal.pageSize.width / 2, y, { align: 'center' });

            doc.save(`quiz_ch5_results_${quizData.id_number}.pdf`); // Updated filename
        }
    </script>
</body>
</html>